axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
omni_ssp5 <- ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_omni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4),
color = "#E38271", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
carni_ssp2 <- ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4),
color = "#E38271", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
carni_ssp2
carni_ssp2 + carni_ssp5 + omni_ssp2 + omni_ssp5
# One map + 4 bars plot=========================================================
ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#fcab8f", linewidth = 2) +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#d92523", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#b7d4ea", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#2e7ebb", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
# One map + 4 bars plot=========================================================
ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#fcab8f", linewidth = 2) +
geom_linerange(data = merged_carni_IQ, aes(x = longitude+0.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#d92523", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#b7d4ea", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#2e7ebb", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
# One map + 4 bars plot=========================================================
ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#fcab8f", linewidth = 2) +
geom_linerange(data = merged_carni_IQ, aes(x = longitude+0.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#d92523", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#fdc38d", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#e25508", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
# One map + 4 bars plot=========================================================
ggplot() +
geom_sf(data = merged_IQ, aes(fill = IQ_children_level)) +
scale_fill_brewer(palette = "Greens", na.value = "grey90") +
labs(title = "Child IQ distribution in China",
fill = "IQ points") +
geom_linerange(data = merged_carni_IQ, aes(x = longitude, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#fcab8f", linewidth = 2) +
geom_linerange(data = merged_carni_IQ, aes(x = longitude+0.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#d92523", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1, ymin = latitude, ymax = latitude + delta_IQ_ssp2_near*1e4, colour = ),
color = "#b7d4ea", linewidth = 2) +
geom_linerange(data = merged_omni_IQ, aes(x = longitude+1.5, ymin = latitude, ymax = latitude + delta_IQ_ssp5_near*1e4, colour = ),
color = "#2e7ebb", linewidth = 2) +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
load("D:/NJU_dissertation/ML_freshwater_wild_fish/Manuscript/Submission/Submission/PNAS/Data_code_availability/Machine_learning/ML_PDP_SHAP.RData")
library(shapr)       # v0.2.2
library(kernelshap)  # v0.4.1
library(shapviz)
rf_shap
#library(shapr)          # v0.2.2
library(DALEX)          # v2.4.3
library(DALEXtra)       # v2.3.0
rf_feature
# PDP plot======================================================================
## Random Forest
model_profile_rf <- model_profile(explainer_rf, type = 'partial',
variables = c('Trophic_level','log_weight',
'Two_m_temperature_yearmax_runmean_K',
'Surface_net_downward_shortwave_flux',
'Potential_evaporation_m',
'Collection_year', 'log_hg_em_lag2',
'Precipitation_yearsum_mm',
'Ten_metre_wind_speed', 'log_ch4_em'
))
#Model explanation==============================================================
set.seed(123)
explainer_rf <- DALEX::explain(rf_final_fit,
data = rd_test[, -5],
y = rd_test$log_mean_mehg,
label = "Random Forest")
explainer_cubist <- DALEX::explain(cubist_final_fit,
data = rd_test[, -5],
y = rd_test$log_mean_mehg,
label = "Cubist")
explainer_svmrbf <- DALEX::explain(svmrbf_final_fit,
data = rd_test_transformed[, -11],
y = rd_test_transformed$log_mean_mehg,
label = "SVM_RBF")
explainer_glm <- DALEX::explain(glm_final_fit,
data = rd_test_transformed[, -11],
y = rd_test_transformed$log_mean_mehg,
label = "Glmnet")
rf_feature <- explainer_rf %>% model_parts() %>% plot(show_boxplots = F) +
ggtitle("Feature Importance ", "")
library(dplyr)          # v1.0.7
library(tidyverse)      # v 2.0.0
library(ggplot2)        # v 3.5.0
library(dplyr)          # v 1.1.4
library(sf)             # v 1.0-15
library(raster)         # v 3.6-26
library(RColorBrewer)   # v 1.1-3
library(patchwork)      # v 1.2.0
library(ggthemes)
setwd("D:/NJU_dissertation/ML_freshwater_wild_fish/Manuscript/Submission/Submission/PNAS/Data_code_availability/Fig. 4")
China_map <- sf::st_read("China_map/China_map.shp")
IQ_piscivore <- read.csv("IQ_piscivore_map_data.csv", header = TRUE)
IQ_omnivore <- read.csv("IQ_omnivore_map_data.csv", header = TRUE)
merged_piscivore <- left_join(China_map, IQ_piscivore, by = "adcode")
merged_omnivore <- left_join(China_map, IQ_omnivore, by = "adcode")
# Per-fetus IQ decrement by consuming piscivore under SSP245 in the near future
merged_piscivore <- merged_piscivore %>%
mutate(
Level_near_ssp2 = case_when(
merged_piscivore$delta_IQ_ssp2_near <= 0.00001 ~ 'Level_1',
merged_piscivore$delta_IQ_ssp2_near > 0.00001 & merged_piscivore$delta_IQ_ssp2_near <= 0.0001 ~ "Level_2",
merged_piscivore$delta_IQ_ssp2_near > 0.0001 & merged_piscivore$delta_IQ_ssp2_near <= 0.0002 ~ "Level_3",
merged_piscivore$delta_IQ_ssp2_near > 0.0002 & merged_piscivore$delta_IQ_ssp2_near <= 0.0003 ~ "Level_4",
merged_piscivore$delta_IQ_ssp2_near > 0.0003 & merged_piscivore$delta_IQ_ssp2_near <= 0.0004 ~ "Level_5",
merged_piscivore$delta_IQ_ssp2_near > 0.0004 ~ "Level_6",
)
)
merged_piscivore$Level_near_ssp2 <- factor(merged_piscivore$Level_near_ssp2)
piscivore_IQ_near_ssp2 <- ggplot() +
geom_sf(data = merged_piscivore, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "piscivore near245",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
piscivore_IQ_near_ssp2
# Per-fetus IQ decrement by consuming piscivore under SSP585 in the near future
merged_piscivore <- merged_piscivore %>%
mutate(
Level_near_ssp5 = case_when(
merged_piscivore$delta_IQ_ssp5_near <= 0.00001 ~ 'Level_1',
merged_piscivore$delta_IQ_ssp5_near > 0.00001 & merged_piscivore$delta_IQ_ssp5_near <= 0.0001 ~ "Level_2",
merged_piscivore$delta_IQ_ssp5_near > 0.0001 & merged_piscivore$delta_IQ_ssp5_near <= 0.0002 ~ "Level_3",
merged_piscivore$delta_IQ_ssp5_near > 0.0002 & merged_piscivore$delta_IQ_ssp5_near <= 0.0003 ~ "Level_4",
merged_piscivore$delta_IQ_ssp5_near > 0.0003 & merged_piscivore$delta_IQ_ssp5_near <= 0.0004 ~ "Level_5",
merged_piscivore$delta_IQ_ssp5_near > 0.0004  ~ "Level_6"
)
)
merged_piscivore$Level_near_ssp5 <- factor(merged_piscivore$Level_near_ssp5)
piscivore_IQ_near_ssp5 <- ggplot() +
geom_sf(data = merged_piscivore, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "piscivore near585",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
piscivore_IQ_near_ssp5
piscivore_IQ_near_ssp2|piscivore_IQ_near_ssp5
#===============================================================================
# Per-fetus IQ decrement by consuming omnivore under SSP245 in the near future
merged_omnivore <- merged_omnivore %>%
mutate(
Level_near_ssp2 = case_when(
merged_omnivore$delta_IQ_ssp2_near <= 0.00001 ~ 'Level_1',
merged_omnivore$delta_IQ_ssp2_near > 0.00001 & merged_omnivore$delta_IQ_ssp2_near <= 0.0001 ~ "Level_2",
merged_omnivore$delta_IQ_ssp2_near > 0.0001 & merged_omnivore$delta_IQ_ssp2_near <= 0.0002 ~ "Level_3",
merged_omnivore$delta_IQ_ssp2_near > 0.0002 & merged_omnivore$delta_IQ_ssp2_near <= 0.0003 ~ "Level_4",
merged_omnivore$delta_IQ_ssp2_near > 0.0003 & merged_omnivore$delta_IQ_ssp2_near <= 0.0004 ~ "Level_5",
merged_omnivore$delta_IQ_ssp2_near > 0.0004 ~ "Level_6"
)
)
merged_omnivore$Level_near_ssp2 <- factor(merged_omnivore$Level_near_ssp2)
omnivore_IQ_near_ssp2 <- ggplot() +
geom_sf(data = merged_omnivore, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Omnivore near245",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
omnivore_IQ_near_ssp2
merged_omnivore <- merged_omnivore %>%
mutate(
Level_near_ssp5 = case_when(
merged_omnivore$delta_IQ_ssp5_near <= 0.00001 ~ 'Level_1',
merged_omnivore$delta_IQ_ssp5_near > 0.00001 & merged_omnivore$delta_IQ_ssp5_near <= 0.0001 ~ "Level_2",
merged_omnivore$delta_IQ_ssp5_near > 0.0001 & merged_omnivore$delta_IQ_ssp5_near <= 0.0002 ~ "Level_3",
merged_omnivore$delta_IQ_ssp5_near > 0.0002 & merged_omnivore$delta_IQ_ssp5_near <= 0.0003 ~ "Level_4",
merged_omnivore$delta_IQ_ssp5_near > 0.0003 & merged_omnivore$delta_IQ_ssp5_near <= 0.0004 ~ "Level_5",
merged_omnivore$delta_IQ_ssp5_near > 0.0004 ~ "Level_6"
)
)
merged_omnivore$Level_near_ssp5 <- factor(merged_omnivore$Level_near_ssp5)
omnivore_IQ_near_ssp5 <- ggplot() +
geom_sf(data = merged_omnivore, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Omnivore near585",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
omnivore_IQ_near_ssp5
omnivore_IQ_near_ssp2|omnivore_IQ_near_ssp5
(piscivore_IQ_near_ssp2|piscivore_IQ_near_ssp5)/
(omnivore_IQ_near_ssp2|omnivore_IQ_near_ssp5)
# Economic loss from IQ decrement for piscivore and omnivore under SSP245 and SSP585 in the near future =========================
EL_piscivore <- read.csv("EL_piscivore_map_data.csv", header = TRUE)
EL_omnivore <- read.csv("EL_omnivore_map_data.csv", header = TRUE)
merged_piscivore <- left_join(China_map, EL_piscivore, by = "adcode")
merged_omnivore <- left_join(China_map, EL_omnivore, by = "adcode")
setwd("D:/NJU_dissertation/ML_freshwater_wild_fish/Manuscript/Submission/Submission/PNAS/Data_code_availability/Fig. 4")
#IQ decrement by consuming piscivore and omnivore under SSP245 and SSP585 in the near future =========================
China_map <- sf::st_read("China_map/China_map.shp")
IQ_piscivore <- read.csv("IQ_piscivore_map_data.csv", header = TRUE)
IQ_omnivore <- read.csv("IQ_omnivore_map_data.csv", header = TRUE)
merged_piscivore_iq <- left_join(China_map, IQ_piscivore, by = "adcode")
merged_omnivore_iq <- left_join(China_map, IQ_omnivore, by = "adcode")
# Per-fetus IQ decrement by consuming piscivore under SSP245 in the near future
merged_piscivore_iq <- merged_piscivore_iq %>%
mutate(
Level_near_ssp2 = case_when(
merged_piscivore_iq$delta_IQ_ssp2_near <= 0.00001 ~ 'Level_1',
merged_piscivore_iq$delta_IQ_ssp2_near > 0.00001 & merged_piscivore_iq$delta_IQ_ssp2_near <= 0.0001 ~ "Level_2",
merged_piscivore_iq$delta_IQ_ssp2_near > 0.0001 & merged_piscivore_iq$delta_IQ_ssp2_near <= 0.0002 ~ "Level_3",
merged_piscivore_iq$delta_IQ_ssp2_near > 0.0002 & merged_piscivore_iq$delta_IQ_ssp2_near <= 0.0003 ~ "Level_4",
merged_piscivore_iq$delta_IQ_ssp2_near > 0.0003 & merged_piscivore_iq$delta_IQ_ssp2_near <= 0.0004 ~ "Level_5",
merged_piscivore_iq$delta_IQ_ssp2_near > 0.0004 ~ "Level_6",
)
)
merged_piscivore_iq$Level_near_ssp2 <- factor(merged_piscivore_iq$Level_near_ssp2)
piscivore_IQ_near_ssp2 <- ggplot() +
geom_sf(data = merged_piscivore_iq, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "piscivore near245",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid  = element_blank())
piscivore_IQ_near_ssp2
# Per-fetus IQ decrement by consuming piscivore under SSP585 in the near future
merged_piscivore_iq <- merged_piscivore_iq %>%
mutate(
Level_near_ssp5 = case_when(
merged_piscivore_iq$delta_IQ_ssp5_near <= 0.00001 ~ 'Level_1',
merged_piscivore_iq$delta_IQ_ssp5_near > 0.00001 & merged_piscivore_iq$delta_IQ_ssp5_near <= 0.0001 ~ "Level_2",
merged_piscivore_iq$delta_IQ_ssp5_near > 0.0001 & merged_piscivore_iq$delta_IQ_ssp5_near <= 0.0002 ~ "Level_3",
merged_piscivore_iq$delta_IQ_ssp5_near > 0.0002 & merged_piscivore_iq$delta_IQ_ssp5_near <= 0.0003 ~ "Level_4",
merged_piscivore_iq$delta_IQ_ssp5_near > 0.0003 & merged_piscivore_iq$delta_IQ_ssp5_near <= 0.0004 ~ "Level_5",
merged_piscivore_iq$delta_IQ_ssp5_near > 0.0004  ~ "Level_6"
)
)
merged_piscivore_iq$Level_near_ssp5 <- factor(merged_piscivore_iq$Level_near_ssp5)
piscivore_IQ_near_ssp5 <- ggplot() +
geom_sf(data = merged_piscivore_iq, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "piscivore near585",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
piscivore_IQ_near_ssp5
#===============================================================================
# Per-fetus IQ decrement by consuming omnivore under SSP245 in the near future
merged_omnivore_iq <- merged_omnivore_iq %>%
mutate(
Level_near_ssp2 = case_when(
merged_omnivore_iq$delta_IQ_ssp2_near <= 0.00001 ~ 'Level_1',
merged_omnivore_iq$delta_IQ_ssp2_near > 0.00001 & merged_omnivore_iq$delta_IQ_ssp2_near <= 0.0001 ~ "Level_2",
merged_omnivore_iq$delta_IQ_ssp2_near > 0.0001 & merged_omnivore_iq$delta_IQ_ssp2_near <= 0.0002 ~ "Level_3",
merged_omnivore_iq$delta_IQ_ssp2_near > 0.0002 & merged_omnivore_iq$delta_IQ_ssp2_near <= 0.0003 ~ "Level_4",
merged_omnivore_iq$delta_IQ_ssp2_near > 0.0003 & merged_omnivore_iq$delta_IQ_ssp2_near <= 0.0004 ~ "Level_5",
merged_omnivore_iq$delta_IQ_ssp2_near > 0.0004 ~ "Level_6"
)
)
merged_omnivore_iq$Level_near_ssp2 <- factor(merged_omnivore_iq$Level_near_ssp2)
omnivore_IQ_near_ssp2 <- ggplot() +
geom_sf(data = merged_omnivore_iq, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Omnivore near245",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
omnivore_IQ_near_ssp2
# Per-fetus IQ decrement by consuming omnivore under SSP585 in the near future
merged_omnivore_iq <- merged_omnivore_iq %>%
mutate(
Level_near_ssp5 = case_when(
merged_omnivore_iq$delta_IQ_ssp5_near <= 0.00001 ~ 'Level_1',
merged_omnivore_iq$delta_IQ_ssp5_near > 0.00001 & merged_omnivore_iq$delta_IQ_ssp5_near <= 0.0001 ~ "Level_2",
merged_omnivore_iq$delta_IQ_ssp5_near > 0.0001 & merged_omnivore_iq$delta_IQ_ssp5_near <= 0.0002 ~ "Level_3",
merged_omnivore_iq$delta_IQ_ssp5_near > 0.0002 & merged_omnivore_iq$delta_IQ_ssp5_near <= 0.0003 ~ "Level_4",
merged_omnivore_iq$delta_IQ_ssp5_near > 0.0003 & merged_omnivore_iq$delta_IQ_ssp5_near <= 0.0004 ~ "Level_5",
merged_omnivore_iq$delta_IQ_ssp5_near > 0.0004 ~ "Level_6"
)
)
merged_omnivore_iq$Level_near_ssp5 <- factor(merged_omnivore_iq$Level_near_ssp5)
omnivore_IQ_near_ssp5 <- ggplot() +
geom_sf(data = merged_omnivore_iq, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Omnivore near585",
fill = "IQ points") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid  = element_blank())
omnivore_IQ_near_ssp5
(piscivore_IQ_near_ssp2|piscivore_IQ_near_ssp5)/
(omnivore_IQ_near_ssp2|omnivore_IQ_near_ssp5)
EL_piscivore <- read.csv("EL_piscivore_map_data.csv", header = TRUE)
EL_omnivore <- read.csv("EL_omnivore_map_data.csv", header = TRUE)
merged_piscivore_el <- left_join(China_map, EL_piscivore, by = "adcode")
merged_omnivore_el <- left_join(China_map, EL_omnivore, by = "adcode")
# Economic loss from IQ decrement for piscivore under SSP245 in the near future
merged_piscivore_el <- merged_piscivore_el %>%
mutate(
Level_near_ssp2 = case_when(
merged_piscivore_el$EL_piscivore_near_ssp2  <= 50000 ~ 'Level_1',
merged_piscivore_el$EL_piscivore_near_ssp2 > 50000 & merged_piscivore_el$EL_piscivore_near_ssp2 <= 100000 ~ "Level_2",
merged_piscivore_el$EL_piscivore_near_ssp2 > 100000 & merged_piscivore_el$EL_piscivore_near_ssp2 <= 300000 ~ "Level_3",
merged_piscivore_el$EL_piscivore_near_ssp2 > 300000 & merged_piscivore_el$EL_piscivore_near_ssp2 <= 500000 ~ "Level_4",
merged_piscivore_el$EL_piscivore_near_ssp2 > 500000 & merged_piscivore_el$EL_piscivore_near_ssp2 <= 1000000 ~ "Level_5",
merged_piscivore_el$EL_piscivore_near_ssp2 > 1000000 ~ "Level_6"
)
)
merged_piscivore_el$Level_near_ssp2 <- factor(merged_piscivore_el$Level_near_ssp2)
piscivore_EL_near_ssp2 <- ggplot() +
geom_sf(data = merged_piscivore_el, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Near SSP245",
fill = "Economic loss (2022USD)") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid = element_blank())
piscivore_EL_near_ssp2
# Economic loss from IQ decrement for piscivore under SSP585 in the near future
merged_piscivore_el <- merged_piscivore_el %>%
mutate(
Level_near_ssp5 = case_when(
merged_piscivore_el$EL_piscivore_near_ssp5  <= 50000 ~ 'Level_1',
merged_piscivore_el$EL_piscivore_near_ssp5 > 50000 & merged_piscivore_el$EL_piscivore_near_ssp5 <= 100000 ~ "Level_2",
merged_piscivore_el$EL_piscivore_near_ssp5 > 100000 & merged_piscivore_el$EL_piscivore_near_ssp5 <= 300000 ~ "Level_3",
merged_piscivore_el$EL_piscivore_near_ssp5 > 300000 & merged_piscivore_el$EL_piscivore_near_ssp5 <= 500000 ~ "Level_4",
merged_piscivore_el$EL_piscivore_near_ssp5 > 500000 & merged_piscivore_el$EL_piscivore_near_ssp5 <= 1000000 ~ "Level_5",
merged_piscivore_el$EL_piscivore_near_ssp5 > 1000000 ~ "Level_6"
)
)
merged_piscivore_el$Level_near_ssp5 <- factor(merged_piscivore_el$Level_near_ssp5)
piscivore_EL_near_ssp5 <- ggplot() +
geom_sf(data = merged_piscivore_el, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Near SSP585",
fill = "Economic loss (2022USD)") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid = element_blank())
piscivore_EL_near_ssp5
#===============================================================================
# Economic loss from IQ decrement for omnivore under SSP245 in the near future
merged_omnivore_el <- merged_omnivore_el %>%
mutate(
Level_near_ssp2 = case_when(
merged_omnivore_el$EL_omnivore_near_ssp2  <= 50000 ~ 'Level_1',
merged_omnivore_el$EL_omnivore_near_ssp2 > 50000 & merged_omnivore_el$EL_omnivore_near_ssp2 <= 100000 ~ "Level_2",
merged_omnivore_el$EL_omnivore_near_ssp2 > 100000 & merged_omnivore_el$EL_omnivore_near_ssp2 <= 300000 ~ "Level_3",
merged_omnivore_el$EL_omnivore_near_ssp2 > 300000 & merged_omnivore_el$EL_omnivore_near_ssp2 <= 500000 ~ "Level_4",
merged_omnivore_el$EL_omnivore_near_ssp2 > 500000 & merged_omnivore_el$EL_omnivore_near_ssp2 <= 1000000 ~ "Level_5",
merged_omnivore_el$EL_omnivore_near_ssp2 > 1000000 ~ "Level_6"
)
)
merged_omnivore_el$Level_near_ssp2 <- factor(merged_omnivore_el$Level_near_ssp2)
omnivore_EL_near_ssp2 <- ggplot() +
geom_sf(data = merged_omnivore_el, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Near SSP245",
fill = "Economic loss (2022USD)") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid = element_blank())
omnivore_EL_near_ssp2
# Economic loss from IQ decrement for omnivore under SSP585 in the near future
merged_omnivore_el <- merged_omnivore_el %>%
mutate(
Level_near_ssp5 = case_when(
merged_omnivore_el$EL_omnivore_near_ssp5  <= 50000 ~ 'Level_1',
merged_omnivore_el$EL_omnivore_near_ssp5 > 50000 & merged_omnivore_el$EL_omnivore_near_ssp5 <= 100000 ~ "Level_2",
merged_omnivore_el$EL_omnivore_near_ssp5 > 100000 & merged_omnivore_el$EL_omnivore_near_ssp5 <= 300000 ~ "Level_3",
merged_omnivore_el$EL_omnivore_near_ssp5 > 300000 & merged_omnivore_el$EL_omnivore_near_ssp5 <= 500000 ~ "Level_4",
merged_omnivore_el$EL_omnivore_near_ssp5 > 500000 & merged_omnivore_el$EL_omnivore_near_ssp5 <= 1000000 ~ "Level_5",
merged_omnivore_el$EL_omnivore_near_ssp5 > 1000000 ~ "Level_6"
)
)
merged_omnivore_el$Level_near_ssp5 <- factor(merged_omnivore_el$Level_near_ssp5)
omnivore_EL_near_ssp5 <- ggplot() +
geom_sf(data = merged_omnivore_el, aes(fill = Level_near_ssp5)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Near SSP585",
fill = "Economic loss (2022USD)") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "none",
panel.grid = element_blank())
omnivore_EL_near_ssp5
(piscivore_EL_near_ssp2|piscivore_EL_near_ssp5)/(omnivore_EL_near_ssp2|omnivore_EL_near_ssp5)
piscivore_EL_near_ssp2 <- ggplot() +
geom_sf(data = merged_piscivore_el, aes(fill = Level_near_ssp2)) +
scale_fill_brewer(palette = "OrRd", na.value = "grey90") +
labs(title = "Near SSP245",
fill = "Economic loss (2022USD)") +
theme(panel.background = element_blank(),
panel.border = element_blank(),
axis.ticks = element_blank(),
axis.text = element_blank(),
legend.position = "left",
panel.grid = element_blank())
piscivore_EL_near_ssp2
(piscivore_EL_near_ssp2|piscivore_EL_near_ssp5)/(omnivore_EL_near_ssp2|omnivore_EL_near_ssp5)
IQ_EL <- piscivore_IQ_near_ssp2 + piscivore_IQ_near_ssp5 + omnivore_IQ_near_ssp2 + omnivore_IQ_near_ssp5 + piscivore_EL_near_ssp2 + piscivore_EL_near_ssp5 + omnivore_EL_near_ssp2 + omnivore_EL_near_ssp5 +
patchwork::plot_layout(design = "
AB
CD
EF
GH")
IQ_EL
